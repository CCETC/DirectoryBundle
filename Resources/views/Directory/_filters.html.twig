{% set hasAdvancedFilters = false %}
{% set hasActiveAdvancedFilters = false %}
{% for filter in listingAdmin.datagrid.filters %}
    {% if filter.options.isAdvanced is defined and filter.options.isAdvanced %}
        {% set hasAdvancedFilters = true %}
        {% if filter.isActive %}
            {% set hasActiveAdvancedFilters = true %}
        {% endif %}
    {% endif %}
{% endfor %}

    <div class="filters-container">
        <h3>Search</h3>
        <form action="{{ url('listings') }}" method="GET">
            <div>
                {% for filter in listingAdmin.datagrid.filters if filter.options.isAdvanced is not defined or not filter.options.isAdvanced %}
                    {% include 'CCETCDirectoryBundle:Directory:_filter.html.twig' %}
                {% endfor %} 
                <div style="clear: both; line-height: 0px;">&nbsp;</div>
            </div>
            <br/>
            {% if hasAdvancedFilters %}
                <div class="more-filters-container" style="{{ not hasActiveAdvancedFilters? 'display: none;' : '' }}">
                    <h4>Advanced Search</h4>

                    {% for filter in listingAdmin.datagrid.filters if filter.options.isAdvanced is defined and filter.options.isAdvanced %}
                        {% include 'CCETCDirectoryBundle:Directory:_filter.html.twig' %}
                    {% endfor %} 
                    <div style="clear: both; line-height: 0px;">&nbsp;</div>
                </div>
            {% endif %}

            <input type="hidden" name="filter[_page]" id="filter__page" value="1" />

            {% set foo = form.children['_page'].setRendered() %}
            {{ form_rest(form) }}

            <div style="clear: both; line-height: 0px;">&nbsp;</div>

            <br/>
            <button type="submit" class="btn btn-primary"><i class="icon-search icon-white"></i> Go</button>
            {% if listingAdmin.datagrid.hasActiveFilters %}<a class="btn btn-link" href="{{ url('listings', {filters: 'reset'}) }}"><i class="icon-trash"></i>  Remove All</a>{% endif %}
            {% if hasAdvancedFilters and not hasActiveAdvancedFilters %}
                <a class="btn less-filters-btn btn-link" style="display: none;" href="#"><i class="icon-remove"></i> Cancel</a>
                <a class="btn more-filters-btn btn-link" href="#"><i class="icon-cog"></i> Advanced Search</a>
            {% endif %}
        </form>
    </div>
